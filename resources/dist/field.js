`,["get",Ct.LOCAL.flag],{"font-scale":1.1}]],["get",Ct.LOCAL.flag]]):d.flag===Ct.AUTO.flag?(o=My().flag,T=["coalesce",["get",o],["get",Ct.LOCAL.flag]]):d===Ct.LOCAL?(o=Ct.LOCAL.flag,T=["get",o]):(o=d.flag,T=["coalesce",["get",o],["get",Ct.LOCAL.flag]]);let{layers:A}=this.getStyle(),z=this.originalLabelStyle.size===0;if(z){let F=jx(A,this);this.isStyleLocalized=Object.keys(F.localized).length>0}for(let F of A){if(F.type!=="symbol")continue;let G=F,$=this.getSource(G.source);if(!$||!("url"in $&&typeof $.url=="string")||new URL($.url).host!==dr.maptilerApiHost)continue;let{id:fe,layout:me}=G;if(!me||!("text-field"in me))continue;let se;if(z?(se=this.getLayoutProperty(fe,"text-field"),this.originalLabelStyle.set(fe,se)):se=this.originalLabelStyle.get(fe),typeof se=="string"){let{contains:Te,exactMatch:je}=Rx(se,this.isStyleLocalized);if(!Te)continue;if(je)this.setLayoutProperty(fe,"text-field",T);else{let $e=Dx(se,T,this.isStyleLocalized);this.setLayoutProperty(fe,"text-field",$e)}}else{let Te=zx(se,T,this.isStyleLocalized);this.setLayoutProperty(fe,"text-field",Te)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(a){if(!this.terrain)return;let p=performance.now(),v=this.terrain.exaggeration,d=a-v,o=()=>{if(!this.terrain||this.terrainFlattening)return;let T=(performance.now()-p)/this.terrainAnimationDuration;if(T<.99){let A=1-(1-T)**4,z=v+A*d;this.terrain.exaggeration=z,requestAnimationFrame(o)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=a,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(o)}enableTerrain(a=this.terrainExaggeration){if(a<0){console.warn("Terrain exaggeration cannot be negative.");return}let p=d=>{!this.terrain||d.type!=="data"||d.dataType!=="source"||!("source"in d)||d.sourceId!=="maptiler-terrain"||d.source.type!=="raster-dem"||d.isSourceLoaded&&(this.off("data",p),this.growTerrain(a))},v=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=a,this.on("data",p),this.addSource(dr.terrainSourceId,{type:"raster-dem",url:dr.terrainSourceURL}),this.setTerrain({source:dr.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(a);return}if(this.loaded()||this.isTerrainEnabled)v();else{let d=()=>{this.getTerrain()&&this.getSource(dr.terrainSourceId)||v()};this.once("load",()=>{d()}),this.once("moveend",()=>{d()})}}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;let a=performance.now(),p=this.terrain.exaggeration,v=()=>{if(!this.terrain||this.terrainGrowing)return;let d=(performance.now()-a)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,d<.99){let o=(1-d)**4,T=p*o;this.terrain.exaggeration=T,requestAnimationFrame(v)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(dr.terrainSourceId)&&this.removeSource(dr.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(v)}setTerrainExaggeration(a,p=!0){!p&&this.terrain?(this.terrainExaggeration=a,this.terrain.exaggeration=a,this.triggerRepaint()):this.enableTerrain(a)}onStyleReady(a){this.isStyleLoaded()?a():this.once("styledata",()=>{a()})}async fitToIpBounds(){let a=await kh.info();this.fitBounds(a.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(a){let p=await kh.info();this.jumpTo({center:[p.longitude??0,p.latitude??0],zoom:a||11})}getCameraHash(){let a=new Float32Array(5),p=this.getCenter();return a[0]=p.lng,a[1]=p.lat,a[2]=this.getZoom(),a[3]=this.getPitch(),a[4]=this.getBearing(),Ty.fromUint8Array(new Uint8Array(a.buffer))}getSdkConfig(){return wi}getMaptilerSessionId(){return Vf}setTransformRequest(a){return super.setTransformRequest(Ay(a)),this}isGlobeProjection(){let a=this.getProjection();return a?a.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}};function Uh(c){let a=c.toString(16);return a.length===1?`0${a}`:a}function oS(c){return`#${Uh(c[0])}${Uh(c[1])}${Uh(c[2])}${c.length===4?Uh(c[3]):""}`}var ot=class c extends Array{constructor(a={}){super(),Ge(this,"min",0),Ge(this,"max",1),"min"in a&&(this.min=a.min),"max"in a&&(this.max=a.max),"stops"in a&&this.setStops(a.stops,{clone:!1})}static fromArrayDefinition(a){return new c({stops:a.map(p=>({value:p[0],color:p[1]}))})}setStops(a,p={clone:!0}){let v=p.clone?this.clone():this;v.length=0;let d=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let T=0;T<a.length;T+=1)d=Math.min(d,a[T].value),o=Math.max(o,a[T].value),v.push({value:a[T].value,color:a[T].color.slice()});return v.sort((T,A)=>T.value<A.value?-1:1),this.min=d,this.max=o,v}scale(a,p,v={clone:!0}){let d=v.clone,o=this[0].value,T=this.at(-1).value-o,A=p-a,z=[];for(let F=0;F<this.length;F+=1){let G=(this[F].value-o)/T*A+a;d?z.push({value:G,color:this[F].color.slice()}):this[F].value=G}return d?new c({stops:z}):this}at(a){return a<0?this[this.length+a]:this[a]}clone(){return new c({stops:this.getRawColorStops()})}getRawColorStops(){let a=[];for(let p=0;p<this.length;p+=1)a.push({value:this[p].value,color:this[p].color});return a}reverse(a={clone:!0}){let p=a.clone?this.clone():this;for(let v=0;v<~~(p.length/2);v+=1){let d=p[v].color;p[v].color=p.at(-(v+1)).color,p.at(-(v+1)).color=d}return p}getBounds(){return{min:this.min,max:this.max}}getColor(a,p={smooth:!0}){if(a<=this[0].value)return this[0].color;if(a>=this.at(-1).value)return this.at(-1).color;for(let v=0;v<this.length-1;v+=1){if(a>this[v+1].value)continue;let d=this[v].color;if(!p.smooth)return d.slice();let o=this[v].value,T=this[v+1].value,A=this[v+1].color,z=(T-a)/(T-o);return d.map((F,G)=>Math.round(F*z+A[G]*(1-z)))}return[0,0,0]}getColorHex(a,p={smooth:!0,withAlpha:!1}){return oS(this.getColor(a,p))}getColorRelative(a,p={smooth:!0}){let v=this.getBounds();return this.getColor(v.min+a*(v.max-v.min),p)}getCanvasStrip(a={horizontal:!0,size:512,smooth:!0}){let p=document.createElement("canvas");p.width=a.horizontal?a.size:1,p.height=a.horizontal?1:a.size;let v=p.getContext("2d");if(!v)throw new Error("Canvs context is missing");let d=v.getImageData(0,0,p.width,p.height),o=d.data,T=a.size,A=this[0].value,z=(this.at(-1).value-A)/T;for(let F=0;F<T;F+=1){let G=this.getColor(A+F*z,{smooth:a.smooth});o[F*4]=G[0],o[F*4+1]=G[1],o[F*4+2]=G[2],o[F*4+3]=G.length>3?G[3]:255}return v.putImageData(d,0,0),p}resample(a,p=15){let v=this.getBounds(),d=this.scale(0,1),o=1/(p-1),T;if(a==="ease-in-square")T=Array.from({length:p},(A,z)=>{let F=z*o,G=F**2,$=d.getColor(G);return{value:F,color:$}});else if(a==="ease-out-square")T=Array.from({length:p},(A,z)=>{let F=z*o,G=1-(1-F)**2,$=d.getColor(G);return{value:F,color:$}});else if(a==="ease-out-sqrt")T=Array.from({length:p},(A,z)=>{let F=z*o,G=F**.5,$=d.getColor(G);return{value:F,color:$}});else if(a==="ease-in-sqrt")T=Array.from({length:p},(A,z)=>{let F=z*o,G=1-(1-F)**.5,$=d.getColor(G);return{value:F,color:$}});else if(a==="ease-out-exp")T=Array.from({length:p},(A,z)=>{let F=z*o,G=1-2**(-10*F),$=d.getColor(G);return{value:F,color:$}});else if(a==="ease-in-exp")T=Array.from({length:p},(A,z)=>{let F=z*o,G=2**(10*F-10),$=d.getColor(G);return{value:F,color:$}});else throw new Error("Invalid ressampling method.");return new c({stops:T}).scale(v.min,v.max)}transparentStart(){let a=this.getRawColorStops();a.unshift({value:a[0].value,color:a[0].color.slice()}),a[1].value+=.001;for(let p of a)p.color.length===3&&p.color.push(255);return a[0].color[3]=0,new c({stops:a})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}},pT={NULL:new ot({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new ot({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new ot({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new ot({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new ot({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new ot({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new ot({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new ot({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new ot({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new ot({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new ot({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new ot({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new ot({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new ot({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new ot({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new ot({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new ot({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new ot({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new ot({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new ot({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new ot({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new ot({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new ot({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new ot({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new ot({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new ot({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new ot({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new ot({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new ot({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new ot({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new ot({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new ot({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new ot({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new ot({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new ot({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new ot({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new ot({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new ot({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new ot({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new ot({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new ot({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new ot({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new ot({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new ot({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new ot({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new ot({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new ot({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new ot({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new ot({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};Ax();var dT=Qe.default.Map,fT=Qe.default.Marker,mT=Qe.default.Popup,gT=Qe.default.Style,yT=Qe.default.CanvasSource,_T=Qe.default.GeoJSONSource,vT=Qe.default.ImageSource,xT=Qe.default.RasterTileSource,bT=Qe.default.RasterDEMTileSource,wT=Qe.default.VectorTileSource,ST=Qe.default.VideoSource,TT=Qe.default.NavigationControl,MT=Qe.default.GeolocateControl,PT=Qe.default.AttributionControl,CT=Qe.default.LogoControl,IT=Qe.default.ScaleControl,AT=Qe.default.FullscreenControl,ET=Qe.default.TerrainControl,kT=Qe.default.BoxZoomHandler,LT=Qe.default.ScrollZoomHandler,zT=Qe.default.CooperativeGesturesHandler,RT=Qe.default.KeyboardHandler,DT=Qe.default.TwoFingersTouchPitchHandler,FT=Qe.default.MapWheelEvent,BT=Qe.default.MapTouchEvent,OT=Qe.default.MapMouseEvent,jT=Qe.default.config,NT=Qe.default.getVersion,{setRTLTextPlugin:UT,getRTLTextPluginStatus:$T,LngLat:VT,LngLatBounds:GT,MercatorCoordinate:ZT,Evented:qT,AJAXError:HT,prewarm:WT,clearPrewarmedResources:XT,Hash:KT,Point:YT,EdgeInsets:JT,DragRotateHandler:QT,DragPanHandler:eM,TwoFingersTouchZoomRotateHandler:tM,DoubleClickZoomHandler:iM,TwoFingersTouchZoomHandler:rM,TwoFingersTouchRotateHandler:nM,getWorkerCount:oM,setWorkerCount:aM,getMaxParallelImageRequests:sM,setMaxParallelImageRequests:lM,getWorkerUrl:cM,setWorkerUrl:uM,addSourceType:hM,importScriptInWorkers:pM,addProtocol:dM,removeProtocol:fM}=Qe.default;function M0(c=5){return Array.from({length:c},(a,p)=>500*Math.pow(2,p))}async function P0(c){return new Promise(a=>setTimeout(a,c))}function C0(c,a){let p=0,v=null,d=null;return(...o)=>{let T=Date.now(),A=a-(T-p);d=o,A<=0?(clearTimeout(v),v=null,p=T,c(...o)):v||(v=setTimeout(()=>{p=Date.now(),v=null,c(...d)},A))}}function bp(c){let a=c&&(c.message||c.toString())||"";return a.includes("ERR_NETWORK_CHANGED")||a.includes("Failed to fetch")||a.includes("NetworkError")}function zl(c,a=6e4){let p=c,v=Date.now();return{try(){let d=Date.now();d-v>=a&&(p=c,v=d);let o=p>0;o&&(p-=1);let T=Math.max(0,a-(d-v));return{ok:o,remaining:p,resetMs:T}},peekResetMs(){let d=Date.now();return Math.max(0,a-(d-v))}}}function I0(c){let a=c.querySelector("[data-mt-lock-shield]");return a||(a=document.createElement("div"),a.setAttribute("data-mt-lock-shield","1"),Object.assign(a.style,{position:"absolute",inset:"0",background:"transparent",zIndex:9998,display:"none"}),c.appendChild(a)),{show(){a.style.display="block"},hide(){a.style.display="none"}}}function A0(c){getComputedStyle(c).position==="static"&&(c.style.position="relative");let p=c.querySelector("[data-mt-throttle-banner]"),v=null;if(p)v=p.querySelector("span")||(()=>{let d=document.createElement("span");return p.appendChild(d),d})();else{p=document.createElement("div"),p.setAttribute("data-mt-throttle-banner","1"),Object.assign(p.style,{position:"absolute",top:"8px",left:"50%",transform:"translateX(-50%)",background:"rgba(220,53,69,.95)",color:"#fff",padding:"6px 10px",borderRadius:"6px",zIndex:9999,font:"600 12px system-ui",boxShadow:"0 4px 12px rgba(0,0,0,.25)",display:"none",alignItems:"center",gap:"6px"});let d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("width","16"),d.setAttribute("height","16"),d.setAttribute("fill","none"),d.setAttribute("stroke","currentColor"),d.setAttribute("stroke-width","2"),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.innerHTML='<circle cx="12" cy="12" r="9"></circle><path d="M12 7v5l3 3"></path>',v=document.createElement("span"),v.textContent="0s",p.appendChild(d),p.appendChild(v),c.appendChild(p)}return{update(d){let o=Math.max(0,Math.ceil(d/1e3));v.textContent=`${o}s`,p.style.display=o>0?"inline-flex":"none"},hide(){p.style.display="none"}}}function k0(c={}){return{...{STREETS:li.STREETS,"STREETS.DARK":li.STREETS.DARK,"STREETS.LIGHT":li.STREETS.LIGHT,OUTDOOR:li.OUTDOOR,WINTER:li.WINTER,SATELLITE:li.SATELLITE,HYBRID:li.HYBRID,DATAVIZ:li.DATAVIZ,"DATAVIZ.DARK":li.DATAVIZ.DARK,"DATAVIZ.LIGHT":li.DATAVIZ.LIGHT},...c}}function L0(c){if(c.language&&(c.language=c.language.toLowerCase(),c.language==="arabic"&&(c.language="ar")),!c.apiKey)throw new Error("MapTiler API key is required");if((!window.__maptilerApiKey||window.__maptilerApiKey!==c.apiKey)&&(wi.apiKey=c.apiKey,window.__maptilerApiKey=c.apiKey),c.language){let a=Ct[c.language]||c.language;wi.primaryLanguage=a}}function aS(c,a,p={},v){if(a){a=a.toLowerCase(),a==="arabic"&&(a="ar");let d=Ct[a]||a;try{c.setLanguage(d)}catch{}}if(p&&Object.keys(p).length){try{c.setLocale(p)}catch{}v&&cS(v,p,a)}}function sS(c){return c.replace(/\./g," ").replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim()}function z0(c){if(typeof c=="string"){let p=document.createElement("div");return p.innerHTML=c.trim(),p.firstElementChild||p}let a=document.createElement("div");return c.className&&(a.className=c.className),c.style&&Object.assign(a.style,c.style),a.innerHTML=c.html||"",a}function R0(c){return{until:0,tickId:null,overlay:null,banner:null,mapRef:null,isLocked(){return Date.now()<this.until},remaining(){return Math.max(0,this.until-Date.now())},lockFor(a){let p=Date.now();this.until=Math.max(this.until,p+a),this.apply(!0),this.startTicker(),c.rateLimitEvent&&Livewire.dispatch(c.rateLimitEvent,{statePath:c.statePath,resetMs:a})},attachMap(a){this.mapRef=a},startTicker(){if(this.tickId)return;let a=()=>{let p=this.remaining();if(this.banner&&this.banner.update(p),p<=0){this.apply(!1),this.stopTicker();return}this.tickId=setTimeout(a,250)};this.tickId=setTimeout(a,0)},stopTicker(){clearTimeout(this.tickId),this.tickId=null,this.banner&&this.banner.hide()},apply(a){if(!(!this.overlay||!this.banner)&&(a?this.overlay.show():this.overlay.hide(),this.mapRef)){if(a)try{this.mapRef.stop()}catch{}a?(this.mapRef.scrollZoom.disable(),this.mapRef.touchZoomRotate.disable(),this.mapRef.dragPan.disable()):(this.mapRef.scrollZoom.enable({around:"center"}),this.mapRef.touchZoomRotate.enable({around:"center"}),this.mapRef.dragPan.enable())}},initUI(a){this.overlay=I0(a),this.banner=A0(a)}}}function D0(c){let a=c.interval;return{geolocate:zl(c.geolocate,a),zoom:zl(c.zoom,a),pinMove:zl(c.pinMove,a),cameraMove:zl(c.cameraMove,a),search:zl(c.search,a)}}function E0({container:c,geo:a,limiters:p,lock:v,lastFix:d,jumpTo:o,cacheMs:T}){let A=c.querySelector(".maplibregl-ctrl-geolocate");if(!A||A.dataset.geoGuarded==="1")return;let z=!1,F=G=>{if(G.preventDefault(),G.stopPropagation(),G.stopImmediatePropagation?.(),v.isLocked())return;let $=p.geolocate.try();if(!$.ok){v.lockFor($.resetMs);return}let fe=Date.now(),me=typeof d=="function"?d():d;if(me&&me.timestamp&&fe-me.timestamp<=(T||1/0)&&o){o({lat:me.lat,lng:me.lng},{zoom:15});return}if(z)return;let se=p.geolocate.try();if(!se.ok){v.lockFor(se.resetMs);return}try{z=!0,a.trigger()}catch{}};A.addEventListener("click",F,{capture:!0}),A.addEventListener("keydown",G=>{(G.key==="Enter"||G.key===" ")&&F(G)},{capture:!0}),A.dataset.geoGuarded="1",a.on("geolocate",()=>z=!1),a.on("error",()=>z=!1)}function F0(c,a,p,v,d,{onGeolocate:o,lastFix:T,jumpTo:A}={}){let z=new tu({trackUserLocation:!0,positionOptions:{enableHighAccuracy:!0,timeout:6e3,maximumAge:0},fitBoundsOptions:{maxZoom:15}});c.addControl(z,"top-right");let F={container:a,geo:z,limiters:v,lock:d};return T&&(F.lastFix=T),A&&(F.jumpTo=A),p&&typeof p.cacheInMs=="number"&&(F.cacheMs=p.cacheInMs),E0(F),c.on("styledata",()=>E0(F)),o&&z.on("geolocate",G=>{d.isLocked()||o(G)}),p&&p.runOnLoad&&c.on("load",()=>{if(d.isLocked())return;let G=v.geolocate.try();if(!G.ok){d.lockFor(G.resetMs);return}try{z.trigger()}catch{}}),z}function rm(c,a,p,v){let d=c.querySelector(".maplibregl-ctrl-zoom-in"),o=c.querySelector(".maplibregl-ctrl-zoom-out"),T=A=>{if(v.isLocked()){A.preventDefault(),A.stopPropagation(),A.stopImmediatePropagation?.();return}let z=p.zoom.try();if(!z.ok){A.preventDefault(),A.stopPropagation(),A.stopImmediatePropagation?.(),v.lockFor(z.resetMs);return}a.__zoomTokenConsumed=!0};[d,o].forEach(A=>{A&&["mousedown","click"].forEach(z=>A.addEventListener(z,T,{capture:!0}))})}function B0(c,a,p,v){a.__zoomTokenConsumed=!1,a.__panTokenConsumed=!1;let d=a.getCenter(),o=a.getZoom(),T=!1,A=se=>{if(se.button===0&&!(se.ctrlKey||se.metaKey||se.altKey)){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}if(!a.__panTokenConsumed){let Te=p.cameraMove.try();if(!Te.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(Te.resetMs);return}a.__panTokenConsumed=!0}}},z=se=>{if(se.isPrimary!==!1){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}if(!a.__panTokenConsumed){let Te=p.cameraMove.try();if(!Te.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(Te.resetMs);return}a.__panTokenConsumed=!0}}},F=se=>{if((se.touches?se.touches.length:0)===1){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}if(!a.__panTokenConsumed){let je=p.cameraMove.try();if(!je.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(je.resetMs);return}a.__panTokenConsumed=!0}}};c.addEventListener("mousedown",A,{capture:!0}),c.addEventListener("pointerdown",z,{capture:!0}),c.addEventListener("touchstart",F,{passive:!1,capture:!0});let G=se=>{if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let Te=p.zoom.try();if(!Te.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(Te.resetMs);return}a.__zoomTokenConsumed=!0};c.addEventListener("wheel",G,{passive:!1,capture:!0});let $=se=>{if((se.touches?se.touches.length:0)>=2){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let je=p.zoom.try();if(!je.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(je.resetMs);return}a.__zoomTokenConsumed=!0}},fe=se=>{(se.touches?se.touches.length:0)>=2&&v.isLocked()&&(se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.())};c.addEventListener("touchstart",$,{passive:!1,capture:!0}),c.addEventListener("touchmove",fe,{passive:!1,capture:!0}),a.on("dblclick",se=>{if(v.isLocked()){se.preventDefault();return}let Te=p.zoom.try();if(!Te.ok){se.preventDefault(),v.lockFor(Te.resetMs);return}a.__zoomTokenConsumed=!0}),a.on("zoomend",()=>{if(a.__zoomTokenConsumed){a.__zoomTokenConsumed=!1,o=a.getZoom();return}if(T){T=!1;return}if(v.isLocked()){T=!0,a.setZoom(o);return}let se=p.zoom.try();se.ok?o=a.getZoom():(T=!0,a.setZoom(o),v.lockFor(se.resetMs))});let me=se=>{let Te=se.key;if(Te==="+"||Te==="="||Te==="-"){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let je=p.zoom.try();if(!je.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(je.resetMs);return}a.__zoomTokenConsumed=!0}if(Te==="ArrowUp"||Te==="ArrowDown"||Te==="ArrowLeft"||Te==="ArrowRight"){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let je=p.cameraMove.try();if(!je.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(je.resetMs);return}a.__panTokenConsumed=!0,setTimeout(()=>a.__panTokenConsumed=!1,250)}};c.addEventListener("keydown",me,{capture:!0}),a.on("dragstart",()=>{if(v.isLocked()){try{a.stop()}catch{}a.setCenter(d);return}if(!a.__panTokenConsumed){let se=p.cameraMove.try();if(!se.ok){try{a.stop()}catch{}a.setCenter(d),v.lockFor(se.resetMs);return}a.__panTokenConsumed=!0}}),a.on("dragend",()=>{a.__panTokenConsumed=!1,d=a.getCenter()}),a.on("moveend",se=>{v.isLocked()||se.originalEvent&&(d=a.getCenter())})}function O0(c,a,p,v,d){class o{onAdd(A){if(this.map=A,this.container=document.createElement("div"),this.container.className="map-tiler-tile-selector maplibregl-ctrl maplibregl-ctrl-group",p.styleSwitcherLabel){let F=document.createElement("label");F.textContent=p.styleSwitcherLabel,this.container.appendChild(F)}let z=document.createElement("select");return Object.keys(a).forEach(F=>{let G=document.createElement("option");G.value=F,G.textContent=sS(F),F===p.style&&(G.selected=!0),z.appendChild(G)}),z.onchange=F=>{if(v&&v.isLocked())return;let G=F.target.value;if(d)d(G);else{let $=a[G]||li.STREETS;c.setStyle($)}},this.container.appendChild(z),this.container}onRemove(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.map=void 0}}c.addControl(new o,"top-right")}async function lS(c,a,p){let v=M0(5);for(let d=0;d<v.length;d++)try{let o=a[p.style]||li.STREETS;return c.setStyle(o),await new Promise((T,A)=>{let z=G=>A(G&&G.error?G.error:new Error("style error")),F=()=>{c.off("error",z),T()};c.once("styledata",F),c.once("error",z)}),!0}catch(o){if(!bp(o))break;await P0(v[d])}return!1}function j0(c,a,p,v){let d=()=>lS(c,a,p).then(T=>{!T&&typeof v=="function"&&v()});c.on("webglcontextlost",T=>{T.preventDefault(),d()});let o=null;c.on("error",T=>{let A=T&&T.error;bp(A)&&(o&&clearTimeout(o),o=setTimeout(()=>d(),150))}),window.addEventListener("online",d),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&d()},{passive:!0})}function cS(c,a={},p){let v=p==="ar",d=(o,T)=>{let A=a[T],z=c.querySelector(o);z&&A&&(z.setAttribute("title",A),z.setAttribute("aria-label",A),v?z.setAttribute("dir","rtl"):z.removeAttribute("dir"))};d(".maplibregl-ctrl-zoom-in","NavigationControl.ZoomIn"),d(".maplibregl-ctrl-zoom-out","NavigationControl.ZoomOut"),d(".maplibregl-ctrl-compass","NavigationControl.ResetBearing"),d(".maplibregl-ctrl-pitchtoggle","NavigationControl.PitchUp"),d(".maplibregl-ctrl-rotate-left","NavigationControl.RotateLeft"),d(".maplibregl-ctrl-rotate-right","NavigationControl.RotateRight"),d(".maplibregl-ctrl-fullscreen","FullscreenControl.Enter"),d(".maplibregl-ctrl-geolocate","GeolocateControl.FindMyLocation")}function N0(){aS(this.map,this.config.language,this.config.controlTranslations,this.$refs.mapContainer)}function U0(){document.visibilityState==="visible"&&navigator.onLine&&this.recreateMapInstance()}function $0(c){if(this.lock&&this.lock.isLocked&&this.lock.isLocked())return;this.config.style=c;let a=this.styles[c]||li.STREETS;try{this.map.setStyle(a)}catch(p){bp(p)?this.hardRefreshSoon():console.error("setStyle failed:",p)}}function V0(){let c=this.marker?this.marker.getLngLat():null,a=this.map?this.map.getZoom():this.config.initialZoomLevel,p=this.config.style;try{this.map&&this.map.remove()}catch{}this.map=null,this.marker=null,this.initMap(),c&&(this.map.setCenter([c.lng,c.lat]),this.map.setZoom(a),this.marker.setLngLat([c.lng,c.lat])),p&&this.setStyle(p)}function uS({config:c}){let a=c;L0(a);let p=k0(a.customStyles),v=D0(a.rateLimit);return{lat:null,lng:null,commitCoordinates:null,config:a,map:null,marker:null,styles:p,lock:R0(a),lastFix:null,init(){Alpine.store("mt")||Alpine.store("mt",{searchQuery:"",localSearchResults:[],isSearching:!1,searchTimeout:null}),this.initMap()},initMap(){let d={...this.getCoordinates()},o=[d.lng,d.lat],T={container:this.$refs.mapContainer,style:this.styles[this.config.style]||li.STREETS,center:o,zoom:this.config.initialZoomLevel,minZoom:this.config.minZoomLevel??void 0,maxZoom:this.config.maxZoomLevel??void 0,navigationControl:!1,geolocateControl:!1,terrainControl:!1,scaleControl:!1,fullscreenControl:!1,projectionControl:!1,hash:!!this.config.hash,maxBounds:this.config.maxBounds||void 0};this.lock.initUI(this.$refs.mapContainer),this.map=new im(T),this.lock.attachMap(this.map);let A=this.map.getCanvasContainer?.()||this.map.getCanvas?.()||this.$refs.mapContainer;B0(A,this.map,v,this.lock),(this.config.rotationable||this.config.zoomable)&&(this.map.addControl(new mu({showCompass:this.config.rotationable,showZoom:this.config.zoomable,visualizePitch:this.config.rotationable}),"top-right"),rm(A,this.map,v,this.lock),this.map.on("styledata",()=>rm(A,this.map,v,this.lock))),this.config.rotationable||(this.map.dragRotate.disable(),this.map.touchZoomRotate.disableRotation()),this.config.zoomable||(this.map.scrollZoom.disable(),this.map.boxZoom.disable(),this.map.doubleClickZoom.disable(),this.map.touchZoomRotate.disable(),this.map.keyboard.disable());let z=this.config.geolocate;z.enabled&&F0(this.map,A,z,v,this.lock,{onGeolocate:G=>{let{latitude:$,longitude:fe,accuracy:me}=G.coords;z.pinAsWell!==!1&&(this.marker.setLngLat([fe,$]),this.lat=$,this.lng=fe,this.commitCoordinates({lat:$,lng:fe})),this.lastFix={lat:$,lng:fe,accuracy:typeof me=="number"?me:null,timestamp:Date.now()}},lastFix:()=>this.lastFix,jumpTo:(G,$)=>this.jumpTo(G,$)}),this.config.showStyleSwitcher&&O0(this.map,this.styles,this.config,this.lock,G=>this.setStyle(G)),this.map.on("load",()=>this.applyLocaleIfNeeded()),this.map.on("styledata",()=>this.applyLocaleIfNeeded()),j0(this.map,this.styles,this.config,()=>this.hardRefreshSoon());let F={draggable:this.config.draggable};this.config.customMarker&&(F.element=z0(this.config.customMarker)),this.marker=new D_(F).setLngLat(o).addTo(this.map),this.lat=d.lat,this.lng=d.lng,this.setCoordinates(d),this.config.clickable&&this.map.on("click",G=>{this.lock.isLocked()||this.markerMoved({latLng:G.lngLat})}),this.config.draggable&&this.marker.on("dragend",()=>{this.lock.isLocked()||this.markerMoved({latLng:this.marker.getLngLat()})}),this.commitCoordinates=C0(G=>{if(this.lock.isLocked())return;let $=v.pinMove.try();$.ok?this.setCoordinates(G):this.lock.lockFor($.resetMs)},300),this.addSearchButton()},setStyle:$0,hardRefreshSoon:U0,recreateMapInstance:V0,applyLocaleIfNeeded:N0,jumpTo(d,{zoom:o}={}){this.marker.setLngLat([d.lng,d.lat]),typeof o=="number"?this.map.jumpTo({center:[d.lng,d.lat],zoom:o}):this.map.jumpTo({center:[d.lng,d.lat]}),this.lat=d.lat,this.lng=d.lng},markerMoved(d){let o=d.latLng;this.lat=o.lat,this.lng=o.lng,this.commitCoordinates({lat:this.lat,lng:this.lng}),this.marker.setLngLat([this.lng,this.lat]),this.map.easeTo({center:[this.lng,this.lat]})},updateMapFromAlpine(){let d=this.getCoordinates(),o=this.marker.getLngLat();(d.lat!==o.lat||d.lng!==o.lng)&&this.updateMap(d)},updateMap(d){this.marker.setLngLat([d.lng,d.lat]),this.map.easeTo({center:[d.lng,d.lat]}),this.lat=d.lat,this.lng=d.lng},setCoordinates(d){this.$wire.set(this.config.statePath,{lat:d.lat,lng:d.lng})},getCoordinates(){let d=this.$wire.get(this.config.statePath);return(!d||!d.lat||!d.lng)&&(d={lat:this.config.defaultLocation.lat,lng:this.config.defaultLocation.lng}),{lat:d.lat,lng:d.lng}},debounceSearch(){let d=Alpine.store("mt");if(d.searchTimeout&&clearTimeout(d.searchTimeout),!d.searchQuery||d.searchQuery.length<3){d.localSearchResults=[],d.isSearching=!1;return}d.isSearching=!0,d.searchTimeout=setTimeout(()=>this.searchLocationFromModal(d.searchQuery),500)},async searchLocationFromModal(d){let o=Alpine.store("mt");if(!d||d.length<3){o.isSearching=!1;return}if(this.lock.isLocked()){o.isSearching=!1;return}let T=v.search.try();if(!T.ok){o.isSearching=!1,this.lock.lockFor(T.resetMs);return}try{let A=await Ud.forward(d);o.localSearchResults=A.features}catch(A){console.error("Search error:",A)}finally{o.isSearching=!1}},selectLocationFromModal(d){let[o,T]=d.center||d.geometry.coordinates;this.map.setCenter([o,T]),this.map.setZoom(15),this.marker.setLngLat([o,T]),this.lat=T,this.lng=o,this.commitCoordinates({lat:T,lng:o});let A=Alpine.store("mt");A.localSearchResults=[],A.searchQuery="",this.$dispatch("close-modal",{id:"location-search-modal"})},addSearchButton(){let d=this;class o{onAdd(A){this.map=A,this.container=document.createElement("div"),this.container.className="maplibregl-ctrl maplibregl-ctrl-group";let z=document.createElement("button");return z.className="items-center",z.style.display="grid",z.style.justifyContent="center",z.type="button",z.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/></svg>',z.title=d.config.searchLocationButtonLabel||"Search Location",z.onclick=()=>{d.lock.isLocked()||d.$dispatch("open-modal",{id:"location-search-modal"})},this.container.appendChild(z),this.container}onRemove(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.map=void 0}}this.map.addControl(new o,"top-left")}}}export{uS as default};
