`,["get",It.LOCAL.flag],{"font-scale":1.1}]],["get",It.LOCAL.flag]]):f.flag===It.AUTO.flag?(o=My().flag,T=["coalesce",["get",o],["get",It.LOCAL.flag]]):f===It.LOCAL?(o=It.LOCAL.flag,T=["get",o]):(o=f.flag,T=["coalesce",["get",o],["get",It.LOCAL.flag]]);let{layers:I}=this.getStyle(),z=this.originalLabelStyle.size===0;if(z){let F=Nx(I,this);this.isStyleLocalized=Object.keys(F.localized).length>0}for(let F of I){if(F.type!=="symbol")continue;let V=F,N=this.getSource(V.source);if(!N||!("url"in N&&typeof N.url=="string")||new URL(N.url).host!==dr.maptilerApiHost)continue;let{id:fe,layout:me}=V;if(!me||!("text-field"in me))continue;let se;if(z?(se=this.getLayoutProperty(fe,"text-field"),this.originalLabelStyle.set(fe,se)):se=this.originalLabelStyle.get(fe),typeof se=="string"){let{contains:Se,exactMatch:De}=Dx(se,this.isStyleLocalized);if(!Se)continue;if(De)this.setLayoutProperty(fe,"text-field",T);else{let Ue=Fx(se,T,this.isStyleLocalized);this.setLayoutProperty(fe,"text-field",Ue)}}else{let Se=Rx(se,T,this.isStyleLocalized);this.setLayoutProperty(fe,"text-field",Se)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(a){if(!this.terrain)return;let p=performance.now(),v=this.terrain.exaggeration,f=a-v,o=()=>{if(!this.terrain||this.terrainFlattening)return;let T=(performance.now()-p)/this.terrainAnimationDuration;if(T<.99){let I=1-(1-T)**4,z=v+I*f;this.terrain.exaggeration=z,requestAnimationFrame(o)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=a,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(o)}enableTerrain(a=this.terrainExaggeration){if(a<0){console.warn("Terrain exaggeration cannot be negative.");return}let p=f=>{!this.terrain||f.type!=="data"||f.dataType!=="source"||!("source"in f)||f.sourceId!=="maptiler-terrain"||f.source.type!=="raster-dem"||f.isSourceLoaded&&(this.off("data",p),this.growTerrain(a))},v=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=a,this.on("data",p),this.addSource(dr.terrainSourceId,{type:"raster-dem",url:dr.terrainSourceURL}),this.setTerrain({source:dr.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(a);return}if(this.loaded()||this.isTerrainEnabled)v();else{let f=()=>{this.getTerrain()&&this.getSource(dr.terrainSourceId)||v()};this.once("load",()=>{f()}),this.once("moveend",()=>{f()})}}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;let a=performance.now(),p=this.terrain.exaggeration,v=()=>{if(!this.terrain||this.terrainGrowing)return;let f=(performance.now()-a)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,f<.99){let o=(1-f)**4,T=p*o;this.terrain.exaggeration=T,requestAnimationFrame(v)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(dr.terrainSourceId)&&this.removeSource(dr.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(v)}setTerrainExaggeration(a,p=!0){!p&&this.terrain?(this.terrainExaggeration=a,this.terrain.exaggeration=a,this.triggerRepaint()):this.enableTerrain(a)}onStyleReady(a){this.isStyleLoaded()?a():this.once("styledata",()=>{a()})}async fitToIpBounds(){let a=await kh.info();this.fitBounds(a.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(a){let p=await kh.info();this.jumpTo({center:[p.longitude??0,p.latitude??0],zoom:a||11})}getCameraHash(){let a=new Float32Array(5),p=this.getCenter();return a[0]=p.lng,a[1]=p.lat,a[2]=this.getZoom(),a[3]=this.getPitch(),a[4]=this.getBearing(),Ty.fromUint8Array(new Uint8Array(a.buffer))}getSdkConfig(){return wi}getMaptilerSessionId(){return Vf}setTransformRequest(a){return super.setTransformRequest(Ay(a)),this}isGlobeProjection(){let a=this.getProjection();return a?a.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}};function Uh(c){let a=c.toString(16);return a.length===1?`0${a}`:a}function aS(c){return`#${Uh(c[0])}${Uh(c[1])}${Uh(c[2])}${c.length===4?Uh(c[3]):""}`}var at=class c extends Array{constructor(a={}){super(),Ge(this,"min",0),Ge(this,"max",1),"min"in a&&(this.min=a.min),"max"in a&&(this.max=a.max),"stops"in a&&this.setStops(a.stops,{clone:!1})}static fromArrayDefinition(a){return new c({stops:a.map(p=>({value:p[0],color:p[1]}))})}setStops(a,p={clone:!0}){let v=p.clone?this.clone():this;v.length=0;let f=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let T=0;T<a.length;T+=1)f=Math.min(f,a[T].value),o=Math.max(o,a[T].value),v.push({value:a[T].value,color:a[T].color.slice()});return v.sort((T,I)=>T.value<I.value?-1:1),this.min=f,this.max=o,v}scale(a,p,v={clone:!0}){let f=v.clone,o=this[0].value,T=this.at(-1).value-o,I=p-a,z=[];for(let F=0;F<this.length;F+=1){let V=(this[F].value-o)/T*I+a;f?z.push({value:V,color:this[F].color.slice()}):this[F].value=V}return f?new c({stops:z}):this}at(a){return a<0?this[this.length+a]:this[a]}clone(){return new c({stops:this.getRawColorStops()})}getRawColorStops(){let a=[];for(let p=0;p<this.length;p+=1)a.push({value:this[p].value,color:this[p].color});return a}reverse(a={clone:!0}){let p=a.clone?this.clone():this;for(let v=0;v<~~(p.length/2);v+=1){let f=p[v].color;p[v].color=p.at(-(v+1)).color,p.at(-(v+1)).color=f}return p}getBounds(){return{min:this.min,max:this.max}}getColor(a,p={smooth:!0}){if(a<=this[0].value)return this[0].color;if(a>=this.at(-1).value)return this.at(-1).color;for(let v=0;v<this.length-1;v+=1){if(a>this[v+1].value)continue;let f=this[v].color;if(!p.smooth)return f.slice();let o=this[v].value,T=this[v+1].value,I=this[v+1].color,z=(T-a)/(T-o);return f.map((F,V)=>Math.round(F*z+I[V]*(1-z)))}return[0,0,0]}getColorHex(a,p={smooth:!0,withAlpha:!1}){return aS(this.getColor(a,p))}getColorRelative(a,p={smooth:!0}){let v=this.getBounds();return this.getColor(v.min+a*(v.max-v.min),p)}getCanvasStrip(a={horizontal:!0,size:512,smooth:!0}){let p=document.createElement("canvas");p.width=a.horizontal?a.size:1,p.height=a.horizontal?1:a.size;let v=p.getContext("2d");if(!v)throw new Error("Canvs context is missing");let f=v.getImageData(0,0,p.width,p.height),o=f.data,T=a.size,I=this[0].value,z=(this.at(-1).value-I)/T;for(let F=0;F<T;F+=1){let V=this.getColor(I+F*z,{smooth:a.smooth});o[F*4]=V[0],o[F*4+1]=V[1],o[F*4+2]=V[2],o[F*4+3]=V.length>3?V[3]:255}return v.putImageData(f,0,0),p}resample(a,p=15){let v=this.getBounds(),f=this.scale(0,1),o=1/(p-1),T;if(a==="ease-in-square")T=Array.from({length:p},(I,z)=>{let F=z*o,V=F**2,N=f.getColor(V);return{value:F,color:N}});else if(a==="ease-out-square")T=Array.from({length:p},(I,z)=>{let F=z*o,V=1-(1-F)**2,N=f.getColor(V);return{value:F,color:N}});else if(a==="ease-out-sqrt")T=Array.from({length:p},(I,z)=>{let F=z*o,V=F**.5,N=f.getColor(V);return{value:F,color:N}});else if(a==="ease-in-sqrt")T=Array.from({length:p},(I,z)=>{let F=z*o,V=1-(1-F)**.5,N=f.getColor(V);return{value:F,color:N}});else if(a==="ease-out-exp")T=Array.from({length:p},(I,z)=>{let F=z*o,V=1-2**(-10*F),N=f.getColor(V);return{value:F,color:N}});else if(a==="ease-in-exp")T=Array.from({length:p},(I,z)=>{let F=z*o,V=2**(10*F-10),N=f.getColor(V);return{value:F,color:N}});else throw new Error("Invalid ressampling method.");return new c({stops:T}).scale(v.min,v.max)}transparentStart(){let a=this.getRawColorStops();a.unshift({value:a[0].value,color:a[0].color.slice()}),a[1].value+=.001;for(let p of a)p.color.length===3&&p.color.push(255);return a[0].color[3]=0,new c({stops:a})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}},dT={NULL:new at({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new at({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new at({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new at({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new at({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new at({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new at({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new at({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new at({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new at({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new at({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new at({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new at({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new at({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new at({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new at({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new at({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new at({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new at({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new at({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new at({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new at({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new at({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new at({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new at({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new at({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new at({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new at({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new at({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new at({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new at({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new at({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new at({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new at({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new at({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new at({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new at({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new at({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new at({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new at({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new at({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new at({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new at({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new at({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new at({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new at({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new at({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new at({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new at({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};Ex();var fT=Qe.default.Map,mT=Qe.default.Marker,gT=Qe.default.Popup,yT=Qe.default.Style,_T=Qe.default.CanvasSource,vT=Qe.default.GeoJSONSource,xT=Qe.default.ImageSource,bT=Qe.default.RasterTileSource,wT=Qe.default.RasterDEMTileSource,ST=Qe.default.VectorTileSource,TT=Qe.default.VideoSource,MT=Qe.default.NavigationControl,PT=Qe.default.GeolocateControl,CT=Qe.default.AttributionControl,IT=Qe.default.LogoControl,AT=Qe.default.ScaleControl,ET=Qe.default.FullscreenControl,kT=Qe.default.TerrainControl,LT=Qe.default.BoxZoomHandler,zT=Qe.default.ScrollZoomHandler,RT=Qe.default.CooperativeGesturesHandler,DT=Qe.default.KeyboardHandler,FT=Qe.default.TwoFingersTouchPitchHandler,BT=Qe.default.MapWheelEvent,OT=Qe.default.MapTouchEvent,jT=Qe.default.MapMouseEvent,NT=Qe.default.config,UT=Qe.default.getVersion,{setRTLTextPlugin:$T,getRTLTextPluginStatus:VT,LngLat:GT,LngLatBounds:ZT,MercatorCoordinate:qT,Evented:HT,AJAXError:WT,prewarm:XT,clearPrewarmedResources:KT,Hash:YT,Point:JT,EdgeInsets:QT,DragRotateHandler:eM,DragPanHandler:tM,TwoFingersTouchZoomRotateHandler:iM,DoubleClickZoomHandler:rM,TwoFingersTouchZoomHandler:nM,TwoFingersTouchRotateHandler:oM,getWorkerCount:aM,setWorkerCount:sM,getMaxParallelImageRequests:lM,setMaxParallelImageRequests:cM,getWorkerUrl:uM,setWorkerUrl:hM,addSourceType:pM,importScriptInWorkers:dM,addProtocol:fM,removeProtocol:mM}=Qe.default;function M0(c=5){return Array.from({length:c},(a,p)=>500*Math.pow(2,p))}async function P0(c){return new Promise(a=>setTimeout(a,c))}function C0(c,a){let p=0,v=null,f=null;return(...o)=>{let T=Date.now(),I=a-(T-p);f=o,I<=0?(clearTimeout(v),v=null,p=T,c(...o)):v||(v=setTimeout(()=>{p=Date.now(),v=null,c(...f)},I))}}function bp(c){let a=c&&(c.message||c.toString())||"";return a.includes("ERR_NETWORK_CHANGED")||a.includes("Failed to fetch")||a.includes("NetworkError")}function zl(c,a=6e4){let p=c,v=Date.now();return{try(){let f=Date.now();f-v>=a&&(p=c,v=f);let o=p>0;o&&(p-=1);let T=Math.max(0,a-(f-v));return{ok:o,remaining:p,resetMs:T}},peekResetMs(){let f=Date.now();return Math.max(0,a-(f-v))}}}function I0(c){let a=c.querySelector("[data-mt-lock-shield]");return a||(a=document.createElement("div"),a.setAttribute("data-mt-lock-shield","1"),Object.assign(a.style,{position:"absolute",inset:"0",background:"transparent",zIndex:9998,display:"none"}),c.appendChild(a)),{show(){a.style.display="block"},hide(){a.style.display="none"}}}function A0(c){getComputedStyle(c).position==="static"&&(c.style.position="relative");let p=c.querySelector("[data-mt-throttle-banner]"),v=null;if(p)v=p.querySelector("span")||(()=>{let f=document.createElement("span");return p.appendChild(f),f})();else{p=document.createElement("div"),p.setAttribute("data-mt-throttle-banner","1"),Object.assign(p.style,{position:"absolute",top:"8px",left:"50%",transform:"translateX(-50%)",background:"rgba(220,53,69,.95)",color:"#fff",padding:"6px 10px",borderRadius:"6px",zIndex:9999,font:"600 12px system-ui",boxShadow:"0 4px 12px rgba(0,0,0,.25)",display:"none",alignItems:"center",gap:"6px"});let f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("width","16"),f.setAttribute("height","16"),f.setAttribute("fill","none"),f.setAttribute("stroke","currentColor"),f.setAttribute("stroke-width","2"),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.innerHTML='<circle cx="12" cy="12" r="9"></circle><path d="M12 7v5l3 3"></path>',v=document.createElement("span"),v.textContent="0s",p.appendChild(f),p.appendChild(v),c.appendChild(p)}return{update(f){let o=Math.max(0,Math.ceil(f/1e3));v.textContent=`${o}s`,p.style.display=o>0?"inline-flex":"none"},hide(){p.style.display="none"}}}function k0(c={}){return{...{STREETS:ot.STREETS,"STREETS.DARK":ot.STREETS.DARK,"STREETS.LIGHT":ot.STREETS.LIGHT,"STREETS.PASTEL":ot.STREETS.PASTEL,OUTDOOR:ot.OUTDOOR,"OUTDOOR.DARK":ot.OUTDOOR.DARK,WINTER:ot.WINTER,"WINTER.DARK":ot.WINTER.DARK,SATELLITE:ot.SATELLITE,HYBRID:ot.HYBRID,BASIC:ot.BASIC,"BASIC.DARK":ot.BASIC.DARK,"BASIC.LIGHT":ot.BASIC.LIGHT,BRIGHT:ot.BRIGHT,"BRIGHT.DARK":ot.BRIGHT.DARK,"BRIGHT.LIGHT":ot.BRIGHT.LIGHT,"BRIGHT.PASTEL":ot.BRIGHT.PASTEL,OPENSTREETMAP:ot.OPENSTREETMAP,TOPO:ot.TOPO,"TOPO.DARK":ot.TOPO.DARK,"TOPO.PASTEL":ot.TOPO.PASTEL,"TOPO.TOPOGRAPHIQUE":ot.TOPO.TOPOGRAPHIQUE,TONER:ot.TONER,"TONER.LITE":ot.TONER.LITE,DATAVIZ:ot.DATAVIZ,"DATAVIZ.DARK":ot.DATAVIZ.DARK,"DATAVIZ.LIGHT":ot.DATAVIZ.LIGHT,BACKDROP:ot.BACKDROP,"BACKDROP.DARK":ot.BACKDROP.DARK,"BACKDROP.LIGHT":ot.BACKDROP.LIGHT,OCEAN:ot.OCEAN,AQUARELLE:ot.AQUARELLE,"AQUARELLE.DARK":ot.AQUARELLE.DARK,"AQUARELLE.VIVID":ot.AQUARELLE.VIVID,LANDSCAPE:ot.LANDSCAPE,"LANDSCAPE.DARK":ot.LANDSCAPE.DARK,"LANDSCAPE.VIVID":ot.LANDSCAPE.VIVID},...c}}function L0(c){if(c.language&&(c.language=c.language.toLowerCase(),c.language==="arabic"&&(c.language="ar")),!c.apiKey)throw new Error("MapTiler API key is required");if((!window.__maptilerApiKey||window.__maptilerApiKey!==c.apiKey)&&(wi.apiKey=c.apiKey,window.__maptilerApiKey=c.apiKey),c.language){let a=It[c.language]||c.language;wi.primaryLanguage=a}}function sS(c,a,p={},v){if(a){a=a.toLowerCase(),a==="arabic"&&(a="ar");let f=It[a]||a;try{c.setLanguage(f)}catch{}}if(p&&Object.keys(p).length){try{c.setLocale(p)}catch{}v&&uS(v,p,a)}}function lS(c){return c.replace(/\./g," ").replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim()}function z0(c){if(typeof c=="string"){let p=document.createElement("div");return p.innerHTML=c.trim(),p.firstElementChild||p}let a=document.createElement("div");return c.className&&(a.className=c.className),c.style&&Object.assign(a.style,c.style),a.innerHTML=c.html||"",a}function R0(c){return{until:0,tickId:null,overlay:null,banner:null,mapRef:null,isLocked(){return Date.now()<this.until},remaining(){return Math.max(0,this.until-Date.now())},lockFor(a){let p=Date.now();this.until=Math.max(this.until,p+a),this.apply(!0),this.startTicker(),c.rateLimitEvent&&Livewire.dispatch(c.rateLimitEvent,{statePath:c.statePath,resetMs:a})},attachMap(a){this.mapRef=a},startTicker(){if(this.tickId)return;let a=()=>{let p=this.remaining();if(this.banner&&this.banner.update(p),p<=0){this.apply(!1),this.stopTicker();return}this.tickId=setTimeout(a,250)};this.tickId=setTimeout(a,0)},stopTicker(){clearTimeout(this.tickId),this.tickId=null,this.banner&&this.banner.hide()},apply(a){if(!(!this.overlay||!this.banner)&&(a?this.overlay.show():this.overlay.hide(),this.mapRef)){if(a)try{this.mapRef.stop()}catch{}a?(this.mapRef.scrollZoom.disable(),this.mapRef.touchZoomRotate.disable(),this.mapRef.dragPan.disable()):(this.mapRef.scrollZoom.enable({around:"center"}),this.mapRef.touchZoomRotate.enable({around:"center"}),this.mapRef.dragPan.enable())}},initUI(a){this.overlay=I0(a),this.banner=A0(a)}}}function D0(c){let a=c.interval;return{geolocate:zl(c.geolocate,a),zoom:zl(c.zoom,a),pinMove:zl(c.pinMove,a),cameraMove:zl(c.cameraMove,a),search:zl(c.search,a)}}function E0({container:c,geo:a,limiters:p,lock:v,lastFix:f,jumpTo:o,cacheMs:T}){let I=c.querySelector(".maplibregl-ctrl-geolocate");if(!I||I.dataset.geoGuarded==="1")return;let z=!1,F=V=>{if(V.preventDefault(),V.stopPropagation(),V.stopImmediatePropagation?.(),v.isLocked())return;let N=p.geolocate.try();if(!N.ok){v.lockFor(N.resetMs);return}let fe=Date.now(),me=typeof f=="function"?f():f;if(me&&me.timestamp&&fe-me.timestamp<=(T||1/0)&&o){o({lat:me.lat,lng:me.lng},{zoom:15});return}if(z)return;let se=p.geolocate.try();if(!se.ok){v.lockFor(se.resetMs);return}try{z=!0,a.trigger()}catch{}};I.addEventListener("click",F,{capture:!0}),I.addEventListener("keydown",V=>{(V.key==="Enter"||V.key===" ")&&F(V)},{capture:!0}),I.dataset.geoGuarded="1",a.on("geolocate",()=>z=!1),a.on("error",()=>z=!1)}function F0(c,a,p,v,f,{onGeolocate:o,lastFix:T,jumpTo:I}={}){let z=new tu({trackUserLocation:!0,positionOptions:{enableHighAccuracy:!0,timeout:6e3,maximumAge:0},fitBoundsOptions:{maxZoom:15}});c.addControl(z,"top-right");let F={container:a,geo:z,limiters:v,lock:f};return T&&(F.lastFix=T),I&&(F.jumpTo=I),p&&typeof p.cacheInMs=="number"&&(F.cacheMs=p.cacheInMs),E0(F),c.on("styledata",()=>E0(F)),o&&z.on("geolocate",V=>{f.isLocked()||o(V)}),p&&p.runOnLoad&&c.on("load",()=>{if(f.isLocked())return;let V=v.geolocate.try();if(!V.ok){f.lockFor(V.resetMs);return}try{z.trigger()}catch{}}),z}function rm(c,a,p,v){let f=c.querySelector(".maplibregl-ctrl-zoom-in"),o=c.querySelector(".maplibregl-ctrl-zoom-out"),T=I=>{if(v.isLocked()){I.preventDefault(),I.stopPropagation(),I.stopImmediatePropagation?.();return}let z=p.zoom.try();if(!z.ok){I.preventDefault(),I.stopPropagation(),I.stopImmediatePropagation?.(),v.lockFor(z.resetMs);return}a.__zoomTokenConsumed=!0};[f,o].forEach(I=>{I&&["mousedown","click"].forEach(z=>I.addEventListener(z,T,{capture:!0}))})}function B0(c,a,p,v){a.__zoomTokenConsumed=!1,a.__panTokenConsumed=!1;let f=a.getCenter(),o=a.getZoom(),T=!1,I=se=>{if(se.button===0&&!(se.ctrlKey||se.metaKey||se.altKey)){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}if(!a.__panTokenConsumed){let Se=p.cameraMove.try();if(!Se.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(Se.resetMs);return}a.__panTokenConsumed=!0}}},z=se=>{if(se.isPrimary!==!1){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}if(!a.__panTokenConsumed){let Se=p.cameraMove.try();if(!Se.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(Se.resetMs);return}a.__panTokenConsumed=!0}}},F=se=>{if((se.touches?se.touches.length:0)===1){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}if(!a.__panTokenConsumed){let De=p.cameraMove.try();if(!De.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(De.resetMs);return}a.__panTokenConsumed=!0}}};c.addEventListener("mousedown",I,{capture:!0}),c.addEventListener("pointerdown",z,{capture:!0}),c.addEventListener("touchstart",F,{passive:!1,capture:!0});let V=se=>{if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let Se=p.zoom.try();if(!Se.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(Se.resetMs);return}a.__zoomTokenConsumed=!0};c.addEventListener("wheel",V,{passive:!1,capture:!0});let N=se=>{if((se.touches?se.touches.length:0)>=2){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let De=p.zoom.try();if(!De.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(De.resetMs);return}a.__zoomTokenConsumed=!0}},fe=se=>{(se.touches?se.touches.length:0)>=2&&v.isLocked()&&(se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.())};c.addEventListener("touchstart",N,{passive:!1,capture:!0}),c.addEventListener("touchmove",fe,{passive:!1,capture:!0}),a.on("dblclick",se=>{if(v.isLocked()){se.preventDefault();return}let Se=p.zoom.try();if(!Se.ok){se.preventDefault(),v.lockFor(Se.resetMs);return}a.__zoomTokenConsumed=!0}),a.on("zoomend",()=>{if(a.__zoomTokenConsumed){a.__zoomTokenConsumed=!1,o=a.getZoom();return}if(T){T=!1;return}if(v.isLocked()){T=!0,a.setZoom(o);return}let se=p.zoom.try();se.ok?o=a.getZoom():(T=!0,a.setZoom(o),v.lockFor(se.resetMs))});let me=se=>{let Se=se.key;if(Se==="+"||Se==="="||Se==="-"){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let De=p.zoom.try();if(!De.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(De.resetMs);return}a.__zoomTokenConsumed=!0}if(Se==="ArrowUp"||Se==="ArrowDown"||Se==="ArrowLeft"||Se==="ArrowRight"){if(v.isLocked()){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.();return}let De=p.cameraMove.try();if(!De.ok){se.preventDefault(),se.stopPropagation(),se.stopImmediatePropagation?.(),v.lockFor(De.resetMs);return}a.__panTokenConsumed=!0,setTimeout(()=>a.__panTokenConsumed=!1,250)}};c.addEventListener("keydown",me,{capture:!0}),a.on("dragstart",()=>{if(v.isLocked()){try{a.stop()}catch{}a.setCenter(f);return}if(!a.__panTokenConsumed){let se=p.cameraMove.try();if(!se.ok){try{a.stop()}catch{}a.setCenter(f),v.lockFor(se.resetMs);return}a.__panTokenConsumed=!0}}),a.on("dragend",()=>{a.__panTokenConsumed=!1,f=a.getCenter()}),a.on("moveend",se=>{v.isLocked()||se.originalEvent&&(f=a.getCenter())})}function O0(c,a,p,v,f){let o;class T{onAdd(z){if(this.map=z,this.container=document.createElement("div"),this.container.className="map-tiler-tile-selector maplibregl-ctrl maplibregl-ctrl-group",p.styleSwitcherLabel){let V=document.createElement("label");V.textContent=p.styleSwitcherLabel,this.container.appendChild(V)}return o=document.createElement("select"),Object.keys(a).filter(V=>p.showSatelliteToggler?V!=="SATELLITE":!0).forEach(V=>{let N=document.createElement("option");N.value=V,N.textContent=lS(V),V===p.style&&(N.selected=!0),o.appendChild(N)}),o.onchange=V=>{if(v&&v.isLocked()||p.showSatelliteToggler&&p._satelliteActive)return;let N=V.target.value;if(f)f(N);else{let fe=a[N]||ot.STREETS;c.setStyle(fe)}},this.container.appendChild(o),this.container}onRemove(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.map=void 0}}return c.addControl(new T,"top-right"),o}function j0(c,a,p,v,f,o){p._satelliteActive=!1;class T{onAdd(z){this.map=z,this.container=document.createElement("div"),this.container.className="map-tiler-satellite-toggle maplibregl-ctrl maplibregl-ctrl-group";let F=document.createElement("button");return F.type="button",F.textContent="\u{1F6F0}\uFE0F",F.setAttribute("aria-label","Toggle satellite"),F.onclick=()=>{if(!(v&&v.isLocked()))if(!p._satelliteActive)this.lastStyle=p.style,p._satelliteActive=!0,f&&(f.disabled=!0),o?o("SATELLITE"):c.setStyle(ot.SATELLITE),F.classList.add("active");else{p._satelliteActive=!1;let V=this.lastStyle||"STREETS";if(o)o(V);else{let N=a[V]||ot.STREETS;c.setStyle(N)}f&&(f.disabled=!1,f.value=V),F.classList.remove("active")}},this.container.appendChild(F),this.container}onRemove(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.map=void 0}}c.addControl(new T,"top-right")}async function cS(c,a,p){let v=M0(5);for(let f=0;f<v.length;f++)try{let o=a[p.style]||ot.STREETS;return c.setStyle(o),await new Promise((T,I)=>{let z=V=>I(V&&V.error?V.error:new Error("style error")),F=()=>{c.off("error",z),T()};c.once("styledata",F),c.once("error",z)}),!0}catch(o){if(!bp(o))break;await P0(v[f])}return!1}function N0(c,a,p,v){let f=()=>cS(c,a,p).then(T=>{!T&&typeof v=="function"&&v()});c.on("webglcontextlost",T=>{T.preventDefault(),f()});let o=null;c.on("error",T=>{let I=T&&T.error;bp(I)&&(o&&clearTimeout(o),o=setTimeout(()=>f(),150))}),window.addEventListener("online",f),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&f()},{passive:!0})}function uS(c,a={},p){let v=p==="ar",f=(o,T)=>{let I=a[T],z=c.querySelector(o);z&&I&&(z.setAttribute("title",I),z.setAttribute("aria-label",I),v?z.setAttribute("dir","rtl"):z.removeAttribute("dir"))};f(".maplibregl-ctrl-zoom-in","NavigationControl.ZoomIn"),f(".maplibregl-ctrl-zoom-out","NavigationControl.ZoomOut"),f(".maplibregl-ctrl-compass","NavigationControl.ResetBearing"),f(".maplibregl-ctrl-pitchtoggle","NavigationControl.PitchUp"),f(".maplibregl-ctrl-rotate-left","NavigationControl.RotateLeft"),f(".maplibregl-ctrl-rotate-right","NavigationControl.RotateRight"),f(".maplibregl-ctrl-fullscreen","FullscreenControl.Enter"),f(".maplibregl-ctrl-geolocate","GeolocateControl.FindMyLocation")}function U0(){sS(this.map,this.config.language,this.config.controlTranslations,this.$refs.mapContainer)}function $0(){document.visibilityState==="visible"&&navigator.onLine&&this.recreateMapInstance()}function V0(c){if(this.lock&&this.lock.isLocked&&this.lock.isLocked())return;this.config.style=c;let a=this.styles[c]||ot.STREETS;try{this.map.setStyle(a)}catch(p){bp(p)?this.hardRefreshSoon():console.error("setStyle failed:",p)}}function G0(){let c=this.marker?this.marker.getLngLat():null,a=this.map?this.map.getZoom():this.config.initialZoomLevel,p=this.config.style;try{this.map&&this.map.remove()}catch{}this.map=null,this.marker=null,this.initMap(),c&&(this.map.setCenter([c.lng,c.lat]),this.map.setZoom(a),this.marker.setLngLat([c.lng,c.lat])),p&&this.setStyle(p)}function hS({config:c}){let a=c;L0(a);let p=k0(a.customStyles),v=D0(a.rateLimits),f=null,o=null,T=R0(a);return{lat:null,lng:null,commitCoordinates:null,config:a,lastFix:null,init(){Object.defineProperties(this,{styles:{value:p},map:{value:null,writable:!0},marker:{value:null,writable:!0},lock:{value:T}}),Alpine.store("mt")||Alpine.store("mt",{searchQuery:"",localSearchResults:[],isSearching:!1,searchTimeout:null}),this.initMap()},initMap(){let I={...this.getCoordinates()},z=[I.lng,I.lat],F={container:this.$refs.mapContainer,style:p[this.config.style]||ot.STREETS,center:z,zoom:this.config.initialZoomLevel,minZoom:this.config.minZoomLevel??void 0,maxZoom:this.config.maxZoomLevel??void 0,navigationControl:!1,geolocateControl:!1,terrainControl:!1,scaleControl:!1,fullscreenControl:!1,projectionControl:!1,hash:!!this.config.hash,maxBounds:this.config.maxBounds||void 0};T.initUI(this.$refs.mapContainer),f=new im(F),this.map=f,T.attachMap(f);let V=f.getCanvasContainer?.()||f.getCanvas?.()||this.$refs.mapContainer;B0(V,f,v,T),(this.config.rotationable||this.config.zoomable)&&(f.addControl(new mu({showCompass:this.config.rotationable,showZoom:this.config.zoomable,visualizePitch:this.config.rotationable}),"top-right"),rm(V,f,v,T),f.on("styledata",()=>rm(V,f,v,T))),this.config.rotationable||(f.dragRotate.disable(),f.touchZoomRotate.disableRotation()),this.config.zoomable||(f.scrollZoom.disable(),f.boxZoom.disable(),f.doubleClickZoom.disable(),f.touchZoomRotate.disable(),f.keyboard.disable());let N=this.config.geolocate;N.enabled&&F0(f,V,N,v,T,{onGeolocate:se=>{let{latitude:Se,longitude:De,accuracy:Ue}=se.coords;N.pinAsWell!==!1&&(o.setLngLat([De,Se]),this.lat=Se,this.lng=De,this.commitCoordinates({lat:Se,lng:De})),this.lastFix={lat:Se,lng:De,accuracy:typeof Ue=="number"?Ue:null,timestamp:Date.now()}},lastFix:()=>this.lastFix,jumpTo:(se,Se)=>this.jumpTo(se,Se)});let fe;this.config.showStyleSwitcher&&(fe=O0(f,p,this.config,T,se=>this.setStyle(se))),this.config.showSatelliteToggler&&j0(f,p,this.config,T,fe,se=>this.setStyle(se)),f.on("load",()=>this.applyLocaleIfNeeded()),f.on("styledata",()=>this.applyLocaleIfNeeded()),N0(f,p,this.config,()=>this.hardRefreshSoon());let me={draggable:this.config.draggable};this.config.customMarker&&(me.element=z0(this.config.customMarker)),o=new D_(me).setLngLat(z).addTo(f),this.marker=o,this.lat=I.lat,this.lng=I.lng,this.setCoordinates(I),this.config.clickable&&f.on("click",se=>{T.isLocked()||this.markerMoved({latLng:se.lngLat})}),this.config.draggable&&o.on("dragend",()=>{T.isLocked()||this.markerMoved({latLng:o.getLngLat()})}),this.commitCoordinates=C0(se=>{if(T.isLocked())return;let Se=v.pinMove.try();Se.ok?this.setCoordinates(se):T.lockFor(Se.resetMs)},300),this.addSearchButton()},setStyle:V0,hardRefreshSoon:$0,recreateMapInstance:G0,applyLocaleIfNeeded:U0,jumpTo(I,{zoom:z}={}){o.setLngLat([I.lng,I.lat]),typeof z=="number"?f.jumpTo({center:[I.lng,I.lat],zoom:z}):f.jumpTo({center:[I.lng,I.lat]}),this.lat=I.lat,this.lng=I.lng},markerMoved(I){let z=I.latLng;this.lat=z.lat,this.lng=z.lng,this.commitCoordinates({lat:this.lat,lng:this.lng}),o.setLngLat([this.lng,this.lat]),f.easeTo({center:[this.lng,this.lat]})},updateMapFromAlpine(){let I=this.getCoordinates(),z=o.getLngLat();(I.lat!==z.lat||I.lng!==z.lng)&&this.updateMap(I)},updateMap(I){o.setLngLat([I.lng,I.lat]),f.easeTo({center:[I.lng,I.lat]}),this.lat=I.lat,this.lng=I.lng},setCoordinates(I){this.$wire.set(this.config.statePath,{lat:I.lat,lng:I.lng})},getCoordinates(){let I=this.$wire.get(this.config.statePath);return(!I||!I.lat||!I.lng)&&(I={lat:this.config.defaultLocation.lat,lng:this.config.defaultLocation.lng}),{lat:I.lat,lng:I.lng}},debounceSearch(){let I=Alpine.store("mt");if(I.searchTimeout&&clearTimeout(I.searchTimeout),!I.searchQuery||I.searchQuery.length<3){I.localSearchResults=[],I.isSearching=!1;return}I.isSearching=!0,I.searchTimeout=setTimeout(()=>this.searchLocationFromModal(I.searchQuery),500)},async searchLocationFromModal(I){let z=Alpine.store("mt");if(!I||I.length<3){z.isSearching=!1;return}if(T.isLocked()){z.isSearching=!1;return}let F=v.search.try();if(!F.ok){z.isSearching=!1,T.lockFor(F.resetMs),this.$dispatch("close-modal",{id:"location-search-modal"});return}try{let V=await Ud.forward(I,{language:this.config.language||"en"});z.localSearchResults=V.features.map(N=>({...N,label:N.place_name||N.text||N.properties?.name||""}))}catch(V){console.error("Search error:",V)}finally{z.isSearching=!1}},selectLocationFromModal(I){let[z,F]=I.center||I.geometry.coordinates;f.setCenter([z,F]),f.setZoom(15),o.setLngLat([z,F]),this.lat=F,this.lng=z,this.commitCoordinates({lat:F,lng:z});let V=Alpine.store("mt");V.localSearchResults=[],V.searchQuery="",this.$dispatch("close-modal",{id:"location-search-modal"})},addSearchButton(){let I=this;class z{onAdd(V){f=V,this.container=document.createElement("div"),this.container.className="maplibregl-ctrl maplibregl-ctrl-group";let N=document.createElement("button");return N.className="items-center",N.style.display="grid",N.style.justifyContent="center",N.type="button",N.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/></svg>',N.title=I.config.searchLocationButtonLabel||"Search Location",N.onclick=()=>{T.isLocked()||I.$dispatch("open-modal",{id:"location-search-modal"})},this.container.appendChild(N),this.container}onRemove(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),f=void 0}}f.addControl(new z,"top-left")}}}export{hS as default};
